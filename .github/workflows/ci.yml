name: CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  validate-android:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
      - name: Validate Android build files
        run: |
          cd packages/android
          echo "Validating Android SDK structure..."
          ls -la src/main/java/com/gamealytics/sdk/
          echo "✅ Android SDK files validated"

  validate-ios:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate iOS SDK structure
        run: |
          cd packages/ios
          echo "Validating iOS SDK structure..."
          ls -la Sources/GameAlytics/
          echo "✅ iOS SDK files validated"

  validate-unity:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate Unity SDK structure
        run: |
          cd packages/unity-package
          echo "Validating Unity SDK structure..."
          ls -la Assets/GameAlytics/Scripts/
          echo "✅ Unity SDK files validated"

  validate-web:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install dependencies
        run: |
          cd packages/web
          npm install --ignore-scripts
      - name: Validate TypeScript compilation
        run: |
          cd packages/web
          npx tsc --noEmit
          echo "✅ Web SDK TypeScript validation passed"

  validate-core:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install dependencies
        run: |
          cd packages/core
          npm install --ignore-scripts
      - name: Validate TypeScript compilation
        run: |
          cd packages/core
          npx tsc --noEmit
          echo "✅ Core SDK TypeScript validation passed"
